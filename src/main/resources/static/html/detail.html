<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Title</title>
        <link type="text/css" rel="stylesheet" href="../../layui/css/layui.css" />
        <style type="text/css">
            body {
                background-color: #D8E6E7;
                padding-bottom: 20px;
            }
            .content-account-text div {
                display: inline-block;
                cursor: pointer;
                margin-left: 20px;
            }
            .content-account-text a:hover {
                color: #e8e8e8;
            }
            .content-account-text a:active {
                color: #000000;
            }
            .content-form-input .layui-input {
                width: 554px;
                margin-top: 12px;
                display: inline-block;
            }
            .content-form-input .layui-btn {
                line-height: 30px;
                padding: 0 12px;
            }
            .detail-content {
                background-color: #60a3bc;
                width: 1080px;
                margin: 10px auto 0;
            }
            .book-info {
                width: 880px !important;
                display: inline-block;
            }
            .other-info {
                width: 200px !important;
                background-color: #3c6382;
                color: #e9e9e9;
                text-align:justify;
                padding: 10px 20px 10px 10px;
            }
            .book-img {
                display: inline-block;
            }
            .book-img img {
                height: 180px;
                width: 140px;
                padding: 0px 0px;
                margin: 10px 0px 0px 20px;
            }
            .book-text {
                width: 680px;
                min-height: 190px;
                display: inline-block;
                vertical-align: top;
                padding-top: 10px;
                padding-left: 10px;
                padding-bottom: 10px;
            }
            .book-text p {
                text-align:justify;
            }
            .other-info-more a {
                cursor: pointer;
                color: #b8deff;
            }
            .other-info-more a:hover {
                color: #ffffff;
            }
            .other-info-more a:active {
                color: #b8deff;
            }
            .comment-select {
                background-color: #4a69bd;
                width: 1080px;
                margin: 5px auto 0;
                text-align: center;
                padding: 5px 0px;
            }
            .comment-select a {
                cursor: pointer;
                color: #9fcdff;
            }
            .comment-select a:hover {
                color: #ffffff;
            }
            .comment-select a:active {
                color: #9fcdff;
            }
            .comment-content {
                background-color: #6a89cc;
                width: 1080px;
                min-height: 150px;
                margin: 0 auto;
                border-bottom: solid 2px #4a69bd;
            }
            .content-user {
                min-height: 150px;
                width: 150px;
                text-align:left;
                display: inline-block;
            }
            .content-user div {
                margin-top: 20px;
                margin-left: 20px;
            }
            .content-username {
                font-size: 15px;
                color: #b8e994;
            }
            .content-like {
                font-size: 18px;
                color: #fad390;
            }
            .content-like i {
                font-size: 22px !important;
                color: #e58e26;
            }
            .content-text {
                width: 850px;
                min-height: 150px;
                display: inline-block;
                text-align:justify;
                padding: 10px 20px;
                color: #e9e9e9;
            }
            .content-button{
                width: 80px;
                min-height: 150px;
                display: inline-block;
            }
            .content-button {

            }
            .content-button .layui-btn {
                margin: 0;
            }
            .content-button button {
                display: block;
                margin-top: 15px !important;
                margin-left: 10px !important;
                width: 50px;
            }
            .comment-selected {
                color: #e9e9e9 !important;
            }
        </style>
    </head>
    <body>
        <div class="home-detail">
            <div class="layui-row detail-content">
                <div class="layui-col-md8 book-info">
                    <div class="book-img">
                        <img src="../book/image/bookImageDefault.png" />
                    </div>
                    <div class="book-text">
                        <p id="bookName">书名：</p>
                        <p id="bookAuthor">作者：</p>
                        <p id="bookPublisher">出版社：</p>
                        <p id="bookPublished">出版时间</p>
                        <p id="bookIsbn">ISBN：</p>
                        <p id="bookDescription" style="white-space: pre-line;">书籍简介：</p>
                    </div>
                </div>
                <div class="layui-col-md4 other-info">
                    <span maxlength=182>
                        资源地址 <p style="color: red;text-align: right;">暂无</p>
                    </span>
                </div>
            </div>
        </div>
        <div class="detail-comment">
            <div class="layui-row comment-select">
                <span><a class="comment-select-a comment-selected" onclick="getOrderBy(this);">最新</a></span>
                <span>/</span>
                <span><a class="comment-select-a" onclick="getOrderBy(this);">最热</a></span>
                <span style="float: right;margin-right: 20px"><a onclick="addComment();">发表品论</a></span>
            </div>
            <!--<div class="layui-row comment-content">
                <div class="layui-col-md2 content-user">
                    <div class="content-username">重度书虫重度书虫重度书虫</div>
                    <div class="content-like"><i class="layui-icon">&#xe6c6;</i>116</div>
                </div>
                <div class="layui-col-md8 content-text">
                    &nbsp&nbsp&nbsp&nbsp书籍简介: 芳踪难觅的栗腹鹭，钟爱旅行的勺嘴鹬
                    感情专一的虎尾海马，雌雄难辨的曲纹唇鱼
                    从海洋到森林，由沙漠至淡水
                    芳踪难觅的栗腹鹭，钟爱旅行的勺嘴鹬
                    感情专一的虎尾海马，雌雄难辨的曲纹唇鱼
                    从海洋到森林，由沙漠至淡水
                    芳踪难觅的栗腹鹭，钟爱旅行的勺嘴鹬
                </div>
                <div class="layui-col-md2 content-button">
                    <button class="layui-btn layui-btn-normal layui-btn-sm" onclick="modifyComment();">编辑</button>
                    <button class="layui-btn layui-btn-danger layui-btn-sm">删除</button>
                    <button class="layui-btn layui-btn-primary layui-btn-sm" onclick="setLike(this);" like="0"><i class="layui-icon">&#xe6c6;</i></button>
                </div>
            </div>-->
        </div>
    </body>
    <script src="../../js/jquery-3.4.1.min.js"></script>
    <script src="../../layui/layui.js"></script>
    <script type="text/javascript">
        var bookId = window.parent.document.bookId;
        console.log(bookId);
        var layer;
        layui.use('layer', function(){
            layer = layui.layer;
            getBookInfo();
        });
        //点赞
        function setLike(element) {
            var flag = $(element).attr("like");
            if(flag == "0") {
                $(element).attr("like", 1);
                $(element).removeClass("layui-btn-primary");
                $(element).addClass("layui-btn-warm");
            } else if(flag == "1") {
                $(element).attr("like", 0);
                $(element).addClass("layui-btn-primary");
                $(element).removeClass("layui-btn-warm");
            }
        }
        //根据最新，最热排序
        function getOrderBy(element) {
            $(".comment-select-a").removeClass("comment-selected");
            $(element).addClass("comment-selected");
        }

        //打开评论编辑窗口
        function modifyComment() {
            layer.open({
                type: 2,
                title: ['编辑', 'background-color: #4a69bd;color:#e9e9e9;'],
                shadeClose: false,
                shade: 0.8,
                area: ['600px', '400px'],
                // offset: ['50%', '50%'],
                content: 'modifyComments.html', //iframe的url
                move: false
            });
        }

        //打开评论新增窗口
        function addComment() {
            window.document.bookId = bookId;
            layer.open({
                type: 2,
                title: ['分享你的想法', 'background-color: #4a69bd;color:#e9e9e9;'],
                shadeClose: false,
                shade: 0.8,
                area: ['600px', '400px'],
                // offset: ['50%', '50%'],
                content: 'addComments.html', //iframe的url
                move: false
            });
        }

        //根据id获取书籍信息
        function getBookInfo() {
            $.ajax({
                type : 'get',
                url : '/book/getBookInfoById?bookId=' + bookId,
                success : function(data) {
                    if(data.success){
                        var bookInfo = data.bookInfo;
                        console.log(bookInfo);
                        $("#bookIsbn").append(bookInfo.bookIsbn);
                        $("#bookName").append(bookInfo.bookName);
                        $("#bookAuthor").append(bookInfo.bookAuthor);
                        $("#bookPublisher").append(bookInfo.bookPublisher);
                        $("#bookPublished").append(bookInfo.bookPublished);
                        var reg = new RegExp(" ","g");
                        $("#bookDescription").append(bookInfo.bookDescription.replace(reg,"<br/>&nbsp&nbsp"));
                        $(".book-img").find("img").prop("src", bookInfo.bookImage);

                        $(".other-info").height($(".book-info")[0].clientHeight)
                    } else {
                        layer.msg(data.message, {shift: -1, time: 1000, icon: 2}, function(){

                        });
                    }
                }
            });
        }
    </script>
</html>